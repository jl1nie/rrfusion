/api/v1/patents/search

Summary ¶
指定したパラメータに応じた検索、集計結果を返す。

このパラメータはPatentfield 通常Webサービスの設定コードの一部をそのまま利用することが可能。https://support.patentfield.com/portal/ja/kb/articles/設定コード

Patentfield 通常Webサービス ヘルプページ https://support.patentfield.com/portal/ja/kb/patentfield

Example URI
POST /api/v1/patents/search
URI ParametersHide
search_type
string (optional) Default: fulltext Example: semantic
検索種別

search_typeがfulltextのとき キーワードによる全文検索。V-gramによる漏れのない検索方式。

search_typeがsemanticのとき 機械学習によって得られた潜在的な意味トピックによる類似文書検索。

search_typeがexpertのとき コマンド検索 https://patentfield.com/help/functions-command-search

search_typeがsimilar_wordsのとき 機械学習によって得られた潜在的な意味トピックによる類似キーワード検索。

search_typeがfeature_wordsのとき 文書番号または文章から特徴語を抽出する。文書番号指定の場合はapp_doc_id:JP2004123456A,app_id:JP20040123456,exam_id:JP6123456Bなど。

Choices: fulltext semantic similar_words feature_words

q
string (optional) Example: 検索エンジン
主検索クエリ: search_typeに応じて挙動が変わる。

search_typeがfulltextのとき キーワード、文献番号、出願人など。 入力が文献番号のような場合はラフな内容でもできるだけ自動的に変換して文献候補一覧を出力する。 ブール演算子 AND(+), OR(OR) ,NOT(-) グルーピング((,)), フレーズ検索("some phrase")、近傍演算子(*N[0-9]+"word1 word2 ... wordN")等が利用可能。

search_typeがsemanticのとき キーワード、自然文もしくは文献番号。 文献番号はできるだけ自動的に変換するが、1つに特定できない入力の場合は、候補の内どれか１つと類似する文書を検索する。

search_typeがexpertのとき コマンド形式である必要がある。 https://support.patentfield.com/portal/ja/kb/articles/コマンド検索

search_typeがsimilar_wordsのとき 辞書に載っているキーワードである必要がある。ただし、7文字以下で辞書に存在しないキーワードの場合は、編集距離が最も近いキーワードに置き換えてから類似キーワード検索する。

sq
string (optional) Example: クエリ
サブ検索クエリ

search_typeがsemanticの場合のみ search_typeがfulltextの場合のqと同様の検索処理が類似検索の前に実行される。
feature
string (optional) Default: word_weights Example: word_weights
対象特徴量: セマンティック検索(search_type: semantic)、特徴語抽出(search_type: feature_words)の場合に特徴を抽出する特許文書の箇所を設定する。

Choices: word_weights: タイトル/要約/請求の範囲/明細書/審査官キーワード claims_weights: タイトル/要約/請求の範囲 all_claims_weights: 請求の範囲 top_claim_weights: 請求の範囲 トップクレーム tbpe_weights: 技術分野/背景技術/課題/効果（JP） tbpes_weights: 技術分野/背景技術/課題/効果/解決手段（JP） tbpea_weights: 技術分野/背景技術/課題/効果/利用可能性（JP） title_weights: 名称 abstract_weights: 要約 problem_weights: 課題（JP） effect_weights: 効果（JP） technical_field_weights: 技術分野（JP） background_weights: 背景技術（JP） solution_weights: 課題を解決するための手段（JP） applicability_weights: 産業上の利用可能性（JP）

columns
array (optional) Example: [app_doc_id,title]
取得する情報 検索項目コードの分析種別がoutputのもののみ指定可能。請求の範囲、明細書などの長文テキストは最大10240文字まで。全文の取得には文献取得APIが必要。

conditions
array (optional) Example: [{"key": "description", "q": "検索クエリ"}]
検索条件 エイリアスc

(object)
key: claims (string) - 検索対象カラム 検索項目コード参照
q: “検索装置” (string) - 検索クエリ（検索項目コードの検索種別に応じて挙動が異なる。）
q1: “2011-10-10” (string) - 検索クエリ(開始条件または大分類)
q2: “2012-10-30” (string) - 検索クエリ(終了条件または小分類)
検索種別がtextのとき 部分一致/近傍
検索種別がexactまたはclassのとき 完全一致/前方一致/あいまい
検索種別がdateまたはnumberのとき 完全一致/範囲/不等号
検索種別がinのとき 完全一致
lop: “and” (string) - 論理演算子 and or not
op: “in” (string) - 検索演算子
in
match
near
fuzzy
between
equal_to
greater_than
greater_than_or_equal_to
less_than
less_than_or_equal_to
prefix: (boolean) - 前方一致検索の場合
interval: 5 (interval) - 近傍検索の最大距離
distance: 2 (interval) - あいまい検索の最大距離
limit
integer (optional) Default: 10 Example: 10
出力件数 最大1000件 ただしcolumnsが番号系と予測ラベル系のみの場合、最大10000

page
integer (optional) Example: 1
出力ページ

offset
integer (optional) Example: 0
出力オフセット件数 pageでページ単位とするかどちらか一方が利用できる

sort_keys
array (optional) Default: [-_score] Example: [-_score]
ソート条件 先頭に-をつけることにより降順、なにもつけなければ昇順になる 検索項目コードの分析種別がsortのもののみ指定可能

score_type
string (optional) Default: tfidf Example: tfidf
スコア種別

score_typeがtfidfのとき キーワードによる全文検索により検索結果が絞り込まれ、qに指定した検索クエリとのtfidfによりスコアが算出される。タイトル、要約、クレーム、明細書でそれぞれ違う重み付けが適用される。

score_typeがpatent_scoreのとき キーワードによる全文検索により検索結果が絞り込まれ、score_conditionsに指定したスコア条件(被引用件数など)でスコアが算出される。

score_typeがsimilarity_scoreのとき 類似検索が行われ、類似度が算出される。（上記、search_typeがsemantic相当）

Choices: tfidf patent_score similarity_score

score_conditions
array (optional) Example: [{"key": "hoge"}]
score_typeがpatent_scoreの時に適用されるスコア条件 エイリアスs スコア項目コードのもののみ指定可能

(object)
type: auto (string) - スコア計算種別
auto
column
index
key: citing_count (string, required) - スコア対象キー カラム名もしくは特殊名
func_type: log (string) - スコア関数種別 日付の場合は減衰関数のみ適用可能
log
min
decay_past_year
decay_rest_year
none
func_value: 0.0 (float) - スコア関数に対する値
q: A80 (string) - スコア計算対象とするクエリ
factor: 1.0 (float) - スコア係数
op: + (string) - スコア計算演算子
weights
array (optional) Default: [{"title": 100, "abstract": 10, "app_claim": 5, "grant_claim": 5, "biblio": 5, "description": 1}] Example: [{"title": 100}]
score_typeがtfidfの時に適用される重み条件

kind_groups
array (optional) Example: ["published_patents_jp","patents_jp"]
公開種別グループ検索対象 kind code(A: “公開公報”, B2: "特許公報"など)を使いやすくまとめたもの。

Choices: published_patents_jp patents_jp published_utility_jp utility_jp published_patents_up published_plants_us patents_us designs_us plants_us

statuses
array (optional) Example: ["published_patents_jp","patents_jp"]
リーガルステータス オリジナルデータのコード体系よりも使いやすくまとめたもの。

Choices: patented_jp expired_jp pending_jp abandoned_jp request_jp live_jp rejected_jp acceralated_jp maintenance_jp rejected_appeal_pending_jp rejected_appeal_success_jp rejected_appeal_failure_jp invalidation_pending_jp invalidation_success_jp invalidation_failure_jp opposition_jp patented_inpadoc expired_inpadoc live_inpadoc granted_inpadoc examined_inpadoc appeal_inpadoc opposition_inpadoc

countries
array (optional) Example: ["JP","US"]
出願国

Choices: JP US

latest
array (optional) Example: ["pub","exam"]
最新更新種別

Choices: pub exam

numbers
array (optional) Example: [{"n": "JP20030123456", "t": "app_id"}, {"n": "JP2003123456", "t": "pub_id"}]
番号一括検索 エイリアスn

(object)
n: JP20030123456 (string, required) - 番号 EPODOC形式 特開2004-123456等でも自動変換される
t: app_id (string, optional) - 番号種別 app_id pub_id exam_id
group_conditions
array (optional) Example: [{"key": "app_year"}, {"key": "apm_applicants"}]
集計分析 エイリアスg

(object)
key: kinds (string, required) - 集計対象 検索項目コードの分析種別がgroupのもののみ指定可能
sort_keys: [-_score] (array, optional) - ソート条件 先頭に-をつけることにより降順、なにもつけなければ昇順になる
limit: 10 (integer, optional) - 集計結果を出力する件数。
offset: 0 (integer, optional) - 集計結果を出力するオフセット値。
q: [“A”,“B2”] (array, optional) - 集計対象とする条件(文字列型の場合)
from: 1990 (integer, optional) - 集計対象とする開始条件(数値型の場合)
to: 2017 (integer, optional) - 集計対象とする終了条件(数値型の場合)
range: 5 (integer, optional) - 集計対象時の集計幅(数値型の場合) たとえば、出願年で5と設定した場合、2000-2005, 2006-2010とレンジでまとめて集計される
unit: month (string, optional) - 日付データの集約単位 day week month year
filter: _key @ 大学 (string, optional) - 集計テーブルフィルター
cross
array (optional) Example: [{"key": "app_year"}, {"key": "apm_applicants"}]
クロス集計分析

(object)
key: kinds (string, required) - クロス集計対象 検索項目コードの分析種別がcrossのもののみ指定可能
top_n: 10 (integer, optional) - クロス集計対象とする上位件数。keyで集約カウントしたときの上位top_n件数がクロス集計対象とされる。
q: [“A”,“B2”] (array, optional) - クロス集計対象とする条件(文字列型の場合)
from: 1990 (integer, optional) - クロス集計対象とする開始条件(数値型の場合)
to: 2017 (integer, optional) - クロス集計対象とする終了条件(数値型の場合)
range: 5 (integer, optional) - クロス集計対象時の集計幅(数値型の場合) たとえば、出願年で5と設定した場合、2000-2005, 2006-2010とレンジでまとめて集計される
unit: month (string, optional) - 日付データの集約単位 day week month year
options
object (optional) Example: {"key": "hoge"}
オプションパラメータ設定

(object)
disable_number_search: false (boolean, optional) - qでの自動番号検索を抑制
disable_stop_word: false (boolean, optional) - ストップワードの使用抑制
similar_options
object (optional) Example: {"key": "hoge"}
search_typeがsemanticの時の類似検索のオプションパラメータ設定

(object)
search_n_terms: 0 (integer) - 類似検索する前にOR検索するワード数 類似度演算対象を減らせるため、高速化が見込める。デフォルトは0
search_n_ipcs: 0 (integer) - 類似検索する前にIPC検索する数 デフォルトは0
search_ipc_type: ipcs (string) - 類似検索する前にIPC検索するIPC種別 ipcs, ipc_classes, ipc_subclasses
top_n_clusters: -1 (integer) - 類似検索対象とするクラスター上位件数 類似検索対象を減らすため、予めクラスタリングした重心のみで類似度を求めてそのクラスターに属するノードで再計算する。-1の場合、top_nの件数が充足するまで順にクラスター数を増やしていく。
top_n: 10000 (integer) - 抽出件数
df_threshold: 0.2 (float) - 一般的な用語を対象から外すためのDF値の閾値
highlight_n_words: 0 (integer) - 類似検索する際、要約をハイライトするワード数。columnsにsim_wordsを指定すると要約でハイライトされるワードおよび類似ワードの組み合わせが出力され、sim_words_highlightを指定すると<span>タグでハイライトされた要約が出力される。
highlight_threshold: 0.7 (float) - 類似ハイライトする閾値(0-1.0)。デフォルト0.7。この数を小さくするとハイライト対象数が増えるが、類似度が低いノイズワードも増える可能性がある。
no_cache
boolean (optional) Example: true
キャッシュを使用しないかどうか デフォルト false

work_group
integer (optional) Example: 1
作業グループ指定

レスポンス例
$ curl -s -X POST  -H "Authorization: Token ${PF_TOKEN}" \
  -H 'Content-Type:application/json' \
  https://api.patentfield.com/api/v1/patents/search \
  -d '{"q":"ソーラーパネル","targets":["title","abstract"],"limit":3,"conditions":[{"key":"ipcs","q":"G06Q50/06","lop":"and","op":"in"}],"columns":["_score","app_id","ipcs","title"],"sort_keys":["-_score"]}' \
  | jq .
{
  "records": [
    {
      "_score": 1,
      "app_id": "JP20140258914",
      "ipcs": [
        "H02J3/38",
        "G06Q50/06",
        "G06Q10/00"
      ],
      "title": "表示装置"
    },
    {
      "_score": 0.7073152374125025,
      "app_id": "JP20160034546",
      "ipcs": [
        "H02J3/38",
        "G06Q50/06",
        "H02J13/00",
        "H02J7/35",
        "H02J3/32",
        "H02J3/00"
      ],
      "title": "逆潮流管理装置、逆潮流管理システム、逆潮流管理方法、および逆潮流管理プログラム"
    },
    {
      "_score": 0.3463299958506784,
      "app_id": "JP20150551271",
      "ipcs": [
        "G06Q50/06",
        "G06Q50/26",
        "G06Q30/02"
      ],
      "title": "太陽光発電評点化システム"
    }
  ],
  "n_hits": 4,
  "stats": {
    "total_request_count": {
      "in_minute": 1,
      "in_hour": 30,
      "in_day": 30,
      "in_month": 30,
      "all": 98
    },
    "total_response_size": {
      "in_minute": 559,
      "in_hour": 27839,
      "in_day": 27839,
      "in_month": 27839,
      "all": 212388
    }
  },
  "limits": {
    "concurrency": 1,
    "request_limit": {
      "by_minute": 60,
      "by_hour": 540,
      "by_day": 8640,
      "by_month": null
    },
    "response_limit": {
      "by_minute": 104857600,
      "by_hour": 1073741824,
      "by_day": 4294967296,
      "by_month": null
    }
  },
  "cachehit": false
}